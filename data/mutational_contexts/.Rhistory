library(MutationalPatterns)
library(BSgenome.SARScov2.NCBI.ASM985889v2)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("GenomeInfoDb")
library(MutationalPatterns)
library(BSgenome.SARScov2.NCBI.ASM985889v2)
library(ggplot2)
library(ggpubr)
library(ggplot2)
library(ggpubr)
library(stringr)
library("rstudioapi")
library(DescTools)
path<-getSourceEditorContext()$path
setwd(SplitPath(path)$dirname)
setwd("../../data/mutational_contexts")
folder<-"../../figures/mutational_contexts"
##Load vcfs
sample_names <-c("Deer Alpha","Deer Delta","Human")
vcf_files<-c("Alpha.clusters.snpeff.nopr.forMutationalSignatures.vcf",
"Delta.clusters.snpeff.nopr.forMutationalSignatures.vcf",
"UShER_all.vcf")
sample_namesS <-c("Deer Alpha","Deer Delta","Human")
vcf_filesS<-c("Alpha.clusters.snpeff.nopr.forMutationalSignatures.synonymous.vcf",
"Delta.clusters.snpeff.nopr.forMutationalSignatures.synonymous.vcf",
"UShER_synonymous.vcf")
###genome
ref_genome<-"BSgenome.SARScov2.NCBI.ASM985889v2"
genome<-getBSgenome(ref_genome)
vcfsA <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
vcfsA <- read_vcfs_as_granges(vcf_files, sample_names, genome = ref_genome)
rlang::last_trace()
View(genome)
View(genome)
?downloadGenomicSequencesFromNCBI
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("BSgenomeForge")
